{% extends "layout.html.twig" %}
{% block javascript %}
		{{ parent() }}
		<script src="js/highcharts.js"></script>
        <script src="js/exporting.js"></script>
        <script src="js/export-csv.js"></script>
        <script src="js/no-data-to-display.js"></script>
	    <script>
            Highcharts.setOptions({
                colors: ["#7cb5ec", "#90ee7e", '#8085e9', "#DF5353", "#f7a35c", "#aaeeee",  "#55BF3B",  "#7798BF", "#aaeeee"]
                //colors: ['#7cb5ec','#434348','#90ed7d','#f7a35c','#8085e9','#f15c80','#e4d354','#8085e8','#8d4653','#91e8e1']
                //colors: ['#058DC7', '#50B432', '#ED561B', '#DDDF00', '#24CBE5', '#64E572', '#FF9655', '#FFF263', '#6AF9C4']
                //colors: ["#7cb5ec", "#90ee7e", "#7798BF", "#f7a35c", "#aaeeee", "#ff0066", "#eeaaee", "#55BF3B", "#DF5353", "#7798BF", "#aaeeee"]
                //colors: ["#DDDF0D", "#7798BF", "#55BF3B", "#DF5353", "#aaeeee", "#ff0066", "#eeaaee", "#55BF3B", "#DF5353", "#7798BF", "#aaeeee"]
                //colors: ["#DDDF0D", "#55BF3B", "#DF5353", "#7798BF", "#aaeeee", "#ff0066", "#eeaaee", "#55BF3B", "#DF5353", "#7798BF", "#aaeeee"]
                //colors: ["#f45b5b", "#8085e9", "#8d4654", "#7798BF", "#aaeeee", "#ff0066", "#eeaaee", "#55BF3B", "#DF5353", "#7798BF", "#aaeeee"]
            });

            $(document).ready(function() {
                $('select').change(function() {
                    $(this).parents('form').submit();
                });

                {{ chartsJS | raw }}

                //Bugfix trick
                $("[id^=collapse]").removeClass("in");
                $("#collapse0").addClass("in");
                $(".indicator:first").removeClass("glyphicon-chevron-down").addClass("glyphicon-chevron-up");

                $("#chartsCollapse").collapse({
					toggle: false
                });

                $("#chartsCollapse").on('shown.bs.collapse hidden.bs.collapse', function() {
					$("[id^=collapse]").each(function() {
						if($(this).hasClass("in")) {
							var element = $(this).parent().find(".indicator").first();
							if(element.hasClass("glyphicon-chevron-down"))
								element.removeClass("glyphicon-chevron-down").addClass("glyphicon-chevron-up");
						} else {
							var element = $(this).parent().find(".indicator").first();
							if(element.hasClass("glyphicon-chevron-up"))
								element.removeClass("glyphicon-chevron-up").addClass("glyphicon-chevron-down");
						}
					});
                });

                $("#chartsCollapse").on('hidden.bs.collapse', function() {
                    console.log($(this));
					$(this).find('.indicator').first().hasClass("glyphicon-chevron-up")
					  .removeClass("glyphicon-chevron-up").addClass("glyphicon-chevron-down");
                });
            });
        </script>
    {% endblock %}
    {% block navigation %}
       {{ parent() }}
       {% if charts is defined and charts != '' %}
       <form method="GET" >
       <div id="charts" style="width: 95%;">
           <div id="navigation" style="text-align: center;">
               <h2>
                   <strong>Job/s details:</strong>
                   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="counters.php?type=TASKS{{ make_execs | raw }}">Tasks & Counters</a>
                   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>Metrics:</strong>
                   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="{{ modifyUrl({'metric': 'CPU'}) }}"><span {% if metric == 'CPU' %}style="font-weight:bold;"{% endif %}>CPU</span></a>
                   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="{{ modifyUrl({'metric': 'Memory'}) }}"><span {% if metric == 'Memory' %}style="font-weight:bold;"{% endif %}>Memory</span></a>
                   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="{{ modifyUrl({'metric': 'Network'}) }}"><span {% if metric == 'Network' %}style="font-weight:bold;"{% endif %}>Network</span></a>
                   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="{{ modifyUrl({'metric': 'Disk'}) }}"><span {% if metric == 'Disk' %}style="font-weight:bold;"{% endif %}>Disk I/O</span></a>
                   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Buffers
               </h2>
               <div id="filters" style="text-align: right;">
				  {% for exec in execs %}
                       <input type="hidden" name="execs[]" value="{{ exec }}">
                  {% endfor %}
                       <input type="hidden" name="metric" value="{{ metric }}">
                       <strong>Filters:</strong> &nbsp;&nbsp;&nbsp;
                       Hosts <select name="hosts">
                           <option value="Slaves" {% if hosts == 'Slaves' %}selected="selected"{% endif %}>All Slaves</option>
                           <option value="Master"{% if hosts == 'Master' %}selected="selected"{% endif %}>Master</option>
                           {% for host_row in host_rows %}
                           <option value="{{ host_row['host_name'] }}" {% if hosts == host_row['host_name'] %}selected="selected"{% endif %}>{{ host_row['host_name'] }}</option>
                           {% endfor %}
                       </select>
                       &nbsp;&nbsp;&nbsp;
                       Aggregation <select name="aggr">
                           <option value="AVG" {% if aggr == 'AVG' %}selected="selected"{% endif %}>AVG</option>
                           <option value="SUM" {% if aggr == 'SUM' %}selected="selected"{% endif %}>SUM</option>
                       </select>
                                                   &nbsp;&nbsp;&nbsp;
                            Detail: <select name="detail">
                                <option value="1" {% if detail == '1' %}selected="selected"{% endif %}>1</option>
                                <option value="3" {% if detail == '3' %}selected="selected"{% endif %}>3</option>
                                <option value="5" {% if detail == '5' %}selected="selected"{% endif %}>5</option>
                                <option value="10" {% if detail == '10' %}selected="selected"{% endif %}>10</option>
                                <option value="20" {% if detail == '20' %}selected="selected"{% endif %}>20</option>
                                <option value="30" {% if detail == '30' %}selected="selected"{% endif %}>30</option>
                                <option value="60" {% if detail == '60' %}selected="selected"{% endif %}>60</option>
                            </select> secs.
                       		<!--<input type="submit" value="submit">-->
               </div>
           </div>
           </br>
           {{ htmlData | raw }}
          {% endif %}
    {% endblock %}